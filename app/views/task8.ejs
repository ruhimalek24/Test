<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Attendance Master</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="">
</head>
<style>
    .container {
        display: flex;
        gap: 20px;
        margin-left: 500px;
    }

    .number {
        font-size: 20px;
    }

    .btn {
        padding: 5px;
        font-size: 16px;
        background-color: lightcyan;
        border-radius: 5px;
    }

    table,
    th,
    td {
        margin-top: 1px;
        border-collapse: collapse;
        text-align: center;
        padding: 5px;
        font-size: 18px;

    }

    th {
        background-color: lightcyan;
        width: 250px;
    }

    h1 {
        text-align: center;
    }
    .dropdown{
        width: 330px;
        margin-left: 150px;
    }
    .month{
        font-size: 20px;
    }
    .select{
        font-size: 16px;
    padding: 10px;
    border-radius: 8px;
    }
    .tag{
        color: gray;
        font-weight: bold;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        text-align: center;
    }
</style>

<body>
    <p class="tag">Ruhi Malek | 24DEV050</p>
    <h1>Attendance Master</h1>
    <div class="dropdown">
        
        <select class="select" id="selector" onchange="month(value)">
            <option value="12">December - 2023</option>
            <option value="1">January - 2024</option>
            <option value="2">February - 2024</option>
        </select>
    </div>
    <div class="container">

        <button class="btn" id="beg" onclick="beg()">
            << </button>

                <button class="btn" id="back" onclick="back()">
                    < </button>

                        <div class="no">
                            <span class="number" id="number">
                                <%= page %>
                            </span>
                        </div>

                        <button class="btn" id="next" onclick="next()"> > </button>

                        <button class="btn" id="end" onclick="end()"> >> </button>

    </div>
    <center>
        <table>
            <thead>
                <th>Student Id</th>
                <th>Student name</th>
                <th>Present days</th>
                <th>Attendance percentage</th>
            </thead>
            <tbody>
                <% data.forEach(i=> {%>
                    <tr>
                        <td>
                            <%= i.student_id %>
                        </td>
                        <td>
                            <%= i.fname %>
                        </td>
                        <td>
                            <%= i.total_attendance %>
                        </td>
                        <td>
                            <%= (Math.floor((i.total_attendance*100)/31)) %>%
                        </td>
                        
                    </tr>

                    <%})%>

            </tbody>
        </table>
    </center>
    <script>
        var begbtn = document.getElementById("beg");
        var endbtn = document.getElementById("end");
        var backButton = document.getElementById("back");
        var nextButton = document.getElementById("next");
        var number = document.getElementById("number");

        var i = 1;

        function ready() {
            backButton.disabled = true;
        }

        function next() {
            let pg = <%= page %> ;
            pg++;
            if (pg == 10) {
                nextButton.disabled = true;
            }
            backButton.disabled = false;
            number.innerHTML = pg;
            loaddata(pg);
            return pg;
        }

        function back() {
            let pg = <%= page %> ;
            pg--;
            if (pg <= 1) {
                backButton.disabled = true;
            }
            nextButton.disabled = false;
            number.innerHTML = pg;
            loaddata(pg);

        }

        function beg() {
            // console.log(1);
            let pg = <%= page %> ;
            if (pg == 1) {
                backButton.disabled = true;
            }
            pg = 1;
            number.innerHTML = pg;
            nextButton.disabled = false;
            loaddata(pg);

        }

        function end() {
            let pg = <%= page %> ;
            if (pg == 10) {
                nextButton.disabled = true;
            }
            pg = 10;
            document.getElementById('number').innerHTML = 10;
            nextButton.disabled = true;
            loaddata(pg);

        }
        function loaddata(pg) {
            window.location.href = `/task8?page=${pg}&month=<%= month %>`;
        }
       function month(value){
            window.location.href = `/task8?page=1&month=${value}`;
       }

       const selector = document.querySelector('#selector');
       selector.value = <%= month%>
    </script>
</body>

</html>